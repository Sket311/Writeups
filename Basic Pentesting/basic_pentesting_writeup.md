# TryHackMe: Basic Pentesting
 
## [Task 1] Web App Testing and Privilege Escalation

To discover the services exposed to this machine you can use nmap.Run command `nmap -sV -vv -open 10.10.118.197` to probe open ports and determine service/version information.
 I found the services exposed to this machine.
 The output of nmap is shown below
 
 <img width="980" alt="1" src="https://user-images.githubusercontent.com/28839345/164305721-5bbffb48-5834-4fa4-9887-253966f19788.png">
<img width="930" alt="2" src="https://user-images.githubusercontent.com/28839345/164305734-062a69ce-2916-42db-8ec3-c608c6978990.png">
 
 To check the hidden directorys on the web server you can use gobuster.From the nmap results you can see that there is a web server running on port 80.Since you have the ip address of the webserver and the port number the command you can use to find name of the hidden directory is 
 `gobuster dir -u http://10.10.118.197:80 -w /usr/share/wordlists/dirb/common.txt`.
 After running gobuster you will see  a directory with the name "development" which is the hidden directory's name you are searching for.
 
 <img width="949" alt="3" src="https://user-images.githubusercontent.com/28839345/164305739-0ae0937d-0e12-48f2-8b2e-5bbb373bd8d8.png">
 
Since nmap results show that there is an smb server running ,enumerate smb server by running the command 
`nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse MACHINE_IP`

<img width="895" alt="4" src="https://user-images.githubusercontent.com/28839345/164305747-04b8ca7f-c073-4cd0-ba49-4aedaf4a8ec4.png">

You will see that there is a share that you can sign in anonymously.Try to connect anonymoysly to the share by running the command 
`smbclient //10.10.118.197/Anonymous`

<img width="699" alt="5" src="https://user-images.githubusercontent.com/28839345/164305756-6bd95863-7989-48c0-935c-36c7efa4c732.png">

When you connect to the smb server check the files and you will see a file called "staff.txt".When you open the file using the command `more staff.txt` at the end of the file you will see the name of two smb share users.The two users are Kay and Jan.

Jan is the first username we are searching for.

<img width="784" alt="6" src="https://user-images.githubusercontent.com/28839345/164305757-9af27193-b07e-4443-97f9-c3093c61fef6.png">

To find the password of this username use hydra and bruteforce the password.The worlist I used is the "rockyou.txt".
`hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.118.197 smb`.

<img width="1339" alt="7" src="https://user-images.githubusercontent.com/28839345/164305759-1c324560-d1a9-4ffa-a7e9-d5da2b1df025.png">

After running the hydra you will find the password "armando"(it may take a couple of minutes ...)

The next step is to connect to Jan using ssh 
`ssh jan@10.10.118.197` using the password armando

<img width="772" alt="8" src="https://user-images.githubusercontent.com/28839345/164305763-f3046196-ae4c-47db-a4a6-b0657c81da58.png">

Go to /home/key/.ssh directory and copy id_rsa key to your local machine.

<img width="602" alt="9" src="https://user-images.githubusercontent.com/28839345/164305765-1812336b-41be-4472-b84f-60c26cf979d8.png">

<img width="760" alt="10" src="https://user-images.githubusercontent.com/28839345/164305770-d2d95b51-d167-4fd7-9899-c062778dcecc.png">

<img width="592" alt="11" src="https://user-images.githubusercontent.com/28839345/164305778-49a0c0df-9877-480d-abe2-dde684717e82.png">

Then give your key the nessacary permissions to to the directory you store the ssh key.
chmod 700 priv_key_directory_name
chmod 600 priv_key
If you try to ssh in to kay you will see that the private key has a passphrase which you can crack it with john the ripper.

First download the ssh2john.py from github and use it to crack the keyphrase
`python ss2john.py priv_key > priv_key.hash`

Then use rockyou.txt to get the final ssh password for keay
`john --wordlist=/usr/share/wordlists/rockyou.txt priv_key.hash

<img width="1300" alt="12" src="https://user-images.githubusercontent.com/28839345/164305791-a4456e42-ad72-4972-9415-88c0024e37fc.png">
`
After you crack the passphrase you can connect to kay using ssh 
`ssh -i priv_key kay@10.10.243.225` and enter passphrase `beeswax`.

Then run the command `more pass.bak` to get the final password `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`


<img width="654" alt="14" src="https://user-images.githubusercontent.com/28839345/164305805-eeb26d43-89e3-4664-900b-5fdda5ad3d20.png">

 **Questions**

**1. What is the name of the hidden directory on the web server(enter name without /)?**
development


**2. What is the username?**
jan

  
**3. What is the password?**
armando

  
**4. What service do you use to access the server(answer in abbreviation in all caps)?**
SSH  

**5. What is the name of the other user you found(all lower case)?**
kay
  

**6. What is the final password you obtain?**

heresareallystrongpasswordthatfollowsthepasswordpolicy$$
